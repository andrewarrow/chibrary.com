dd if=/dev/zero of=ubuntu.fs count=512 bs=1M
mke2fs -F ubuntu.fs
sudo mount -o loop ubuntu.fs /mnt
sudo debootstrap gutsy /mnt # change to current ver, of course
sudo chroot /mnt
# add 'universe multiverse restricted' to /etc/apt/sources.list
passwd
aptitude update ; aptitude safe-upgrade
aptitude purge ubuntu-minimal wpasupplicant console-terminus console-tools console-setup python-common python2.5 python alsa-utils lsb-release pcmciautils reiser4progs reiserfsprogs xfsprogs wireless-tools memtest86+ jfsutils hfsplus hfsutils 
aptitude install openssh-server subversion ruby irb rubygems libopenssl-ruby libc6-xen host ssh
# may need to add 'exit 0' to /usr/sbin/invoke-rc.d to install openssh-server
aptitude autoclean
gem install -y --no-rdoc --no-ri # ...paste list from doc/gems
gem cleanup
# run 'date', sanity check it's UTC
vi /etc/ssh/sshd_config:
  PermitRootLogin without-password
  UseDNS no
# add rc.local
rm -rf /opt /srv /home /etc/event.d/tty* /var/log/*
mkdir /m
# add fstab
exit
df -h # note size
sudo umount /mnt

# bundle and upload the AMI
e2fsck -f ubuntu.fs
resize2fs -p ubuntu.fs 1234M # size from df -h + ~10M
time ec2-ami-tools/bin/ec2-bundle-image -i ubuntu.fs -u '5906-9161-4368' -c ~/.ec2/cert-XTZONLJE24FFLKW3E75MEIE6JPPEEDX3.pem -k ~/.ec2/pk-XTZONLJE24FFLKW3E75MEIE6JPPEEDX3.pem 
# remove old AMI from s3
time ec2-ami-tools/bin/ec2-upload-bundle -b listlibrary_ec2 -m /tmp/ubuntu.fs.manifest.xml -a 0B8FSQ35925T27X8Q4R2 -s 'ryM3xNKV/3OL9j5jMeJHRqSzWETxK5MeSlXj6/rv'
ec2-ami-tools/bin/ec2-register listlibrary_ec2/ubuntu.fs.manifest.xml

# Notes on installing tools on Ubuntu from
# http://developer.amazonwebservices.com/connect/entry.jspa?externalID=368&categoryID=88
apt-get install wget alien ruby libopenssl-ruby1.8 rsync curl
wget <download link for ec2-ami-tools.noarch.rpm>
alien -i ec2-ami-tools.noarch.rpm
ln -sf /bin/bash /bin/sh # Ubuntu changed to dash, which is more posixy
ln -s /usr/lib/site_ruby/aes /usr/local/lib/site_ruby/1.8/i486-linux/aes

Edit: /usr/lib/site_ruby/aes/amiutil/image.rb line ~150
Change: exec( 'for i in console null zero ; do /sbin/MAKEDEV -d ' + dev_dir + ' -x $i ; done' )
To: exec("cd #{dev_dir} && /sbin/MAKEDEV console && /sbin/MAKEDEV std && /sbin/MAKEDEV generic")
